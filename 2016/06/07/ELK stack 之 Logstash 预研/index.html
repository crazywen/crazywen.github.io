<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="黑夜降临那一刻，我就这那里"><title>ELK stack 之 Logstash  预研 | 深度空间</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.1.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ELK stack 之 Logstash  预研</h1><a id="logo" href="/.">深度空间</a><p class="description">渴望展翅翱翔</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ELK stack 之 Logstash  预研</h1><div class="post-meta">Jun 7, 2016<span> | </span><span class="category"><a href="/categories/技术/">技术</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/06/07/ELK stack 之 Logstash 预研/" href="/2016/06/07/ELK stack 之 Logstash 预研/#comments" class="ds-thread-count"></a><div class="post-content"><p>&lt;!-- toc --&gt;</p>
<ul>
<li><a href="#%E6%AD%A4%E6%AC%A1%E5%AF%B9elkstack%E7%9A%84logstash%E9%A2%84%E7%A0%94%E7%9A%84%E7%9B%AE%E7%9A%84">&#x6B64;&#x6B21;&#x5BF9;ELKstack&#x7684;LogStash&#x9884;&#x7814;&#x7684;&#x76EE;&#x7684;</a></li>
<li><a href="#elk-stack-%E6%98%AF%E4%BB%80%E4%B9%88">ELK stack &#x662F;&#x4EC0;&#x4E48;&#xFF1F;</a>
<ul>
<li><a href="#1-logstash%E6%98%AF%E4%BB%80%E4%B9%88">1. LogStash&#x662F;&#x4EC0;&#x4E48;&#xFF1F;</a></li>
<li><a href="#2-logstash%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88">2. LogStash&#x80FD;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;</a></li>
<li><a href="#3%E6%80%8E%E6%A0%B7%E9%9B%86%E6%88%90%E4%BD%BF%E6%88%91%E4%BB%AC%E7%9A%84%E8%BF%90%E7%BB%B4%E5%B9%B3%E5%8F%B0%E5%85%BC%E5%85%B7%E5%AE%9E%E6%97%B6%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%9A%84%E8%83%BD%E5%8A%9B">3.&#x600E;&#x6837;&#x96C6;&#x6210;&#xFF0C;&#x4F7F;&#x6211;&#x4EEC;&#x7684;&#x8FD0;&#x7EF4;&#x5E73;&#x53F0;&#x517C;&#x5177;&#x5B9E;&#x65F6;&#x65E5;&#x5FD7;&#x5206;&#x6790;&#x7684;&#x80FD;&#x529B;</a></li>
</ul>
</li>
<li><a href="#elk%E7%9A%84%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88">ELK&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;</a>
<ul>
<li><a href="#%E4%B8%80%E4%B8%AA%E6%9C%80%E5%B0%8F%E7%9A%84%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E6%98%AF">&#x4E00;&#x4E2A;&#x6700;&#x5C0F;&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;&#x662F;&#xFF1A;</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8filters">&#x4F7F;&#x7528;Filters</a></li>
<li><a href="#%E6%89%A9%E5%B1%95%E5%88%B0%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E7%9A%84elasticsearch%E9%9B%86%E7%BE%A4">&#x6269;&#x5C55;&#x5230;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;Elasticsearch&#x96C6;&#x7FA4;</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%AE%A1%E7%90%86%E5%90%9E%E5%90%90%E7%9A%84%E5%B3%B0%E5%80%BC">&#x4F7F;&#x7528;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7BA1;&#x7406;&#x541E;&#x5410;&#x7684;&#x5CF0;&#x503C;</a></li>
<li><a href="#logstash%E5%A4%9A%E8%BF%9E%E6%8E%A5%E7%9A%84%E9%AB%98%E5%8F%AF%E7%94%A8logstash-%E9%9B%86%E7%BE%A4">LogStash&#x591A;&#x8FDE;&#x63A5;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x2014;&#x2014;logStash &#x96C6;&#x7FA4;</a></li>
</ul>
</li>
<li><a href="#%E6%9C%80%E5%90%8E%E5%8F%AF%E4%BC%B8%E7%BC%A9%E7%9A%84logstash%E5%BA%94%E8%AF%A5%E5%85%B7%E5%A4%87%E7%9A%84%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7">&#x6700;&#x540E;&#xFF0C;&#x53EF;&#x4F38;&#x7F29;&#x7684;Logstash&#x5E94;&#x8BE5;&#x5177;&#x5907;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x6027;</a></li>
</ul>
<p>&lt;!-- tocstop --&gt;</p>
<hr>
<h3 id="&#x6B64;&#x6B21;&#x5BF9;elkstack&#x7684;logstash&#x9884;&#x7814;&#x7684;&#x76EE;&#x7684;">&#x6B64;&#x6B21;&#x5BF9;ELKstack&#x7684;LogStash&#x9884;&#x7814;&#x7684;&#x76EE;&#x7684;</h3>
<blockquote>
<ol>
<li>&#x4E86;&#x89E3;<strong>LogStash&#x662F;&#x4EC0;&#x4E48;</strong>&#xFF1F;</li>
<li>LogStash<strong>&#x80FD;&#x505A;&#x4EC0;&#x4E48;</strong>&#xFF1F;</li>
<li>&#x600E;&#x6837;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x4E2D;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#xFF0C;<strong>&#x662F;&#x5426;&#x80FD;&#x5F88;&#x597D;&#x7684;&#x5951;&#x5408;&#x6211;&#x4EEC;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x6C42;</strong>&#xFF1F;</li>
</ol>
</blockquote>
<h3 id="elk-stack-&#x662F;&#x4EC0;&#x4E48;">ELK stack &#x662F;&#x4EC0;&#x4E48;&#xFF1F;</h3>
<p>ELK Stack &#x662F; <strong>Elasticsearch&#x3001;Logstash&#x3001;Kibana</strong> &#x4E09;&#x4E2A;&#x5F00;&#x6E90;&#x8F6F;&#x4EF6;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x5728;&#x5B9E;&#x65F6;&#x6570;&#x636E;&#x68C0;&#x7D22;&#x548C;&#x5206;&#x6790;&#x573A;&#x5408;&#xFF0C;&#x4E09;&#x8005;&#x901A;&#x5E38;&#x662F;&#x914D;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x800C;&#x4E14;&#x53C8;&#x90FD;&#x5148;&#x540E;&#x5F52;&#x4E8E; Elastic.co &#x516C;&#x53F8;&#x540D;&#x4E0B;&#xFF0C;&#x6545;&#x6709;&#x6B64;&#x7B80;&#x79F0;&#x3002;
ELK Stack &#x5728;&#x6700;&#x8FD1;&#x4E24;&#x5E74;&#x8FC5;&#x901F;&#x5D1B;&#x8D77;&#xFF0C;&#x6210;&#x4E3A;&#x673A;&#x5668;&#x6570;&#x636E;&#x5206;&#x6790;&#xFF0C;&#x6216;&#x8005;&#x8BF4;<strong>&#x5B9E;&#x65F6;&#x65E5;&#x5FD7;&#x5904;&#x7406;</strong>&#x9886;&#x57DF;&#xFF0C;&#x5F00;&#x6E90;&#x754C;&#x7684;&#x7B2C;&#x4E00;&#x9009;&#x62E9;&#x3002;&#x548C;&#x4F20;&#x7EDF;&#x7684;&#x65E5;&#x5FD7;&#x5904;&#x7406;&#x65B9;&#x6848;&#x76F8;&#x6BD4;&#xFF0C;ELK Stack &#x5177;&#x6709;&#x5982;&#x4E0B;&#x51E0;&#x4E2A;&#x4F18;&#x70B9;&#xFF1A;</p>
<blockquote>
<ul>
<li>&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x7075;&#x6D3B;&#x3002;Elasticsearch &#x662F;&#x5B9E;&#x65F6;&#x5168;&#x6587;&#x7D22;&#x5F15;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x50CF; storm &#x90A3;&#x6837;&#x9884;&#x5148;&#x7F16;&#x7A0B;&#x624D;&#x80FD;&#x4F7F;&#x7528;&#xFF1B;</li>
<li>&#x914D;&#x7F6E;&#x7B80;&#x6613;&#x4E0A;&#x624B;&#x3002;Elasticsearch &#x5168;&#x90E8;&#x91C7;&#x7528; JSON &#x63A5;&#x53E3;&#xFF0C;Logstash &#x662F; Ruby DSL &#x8BBE;&#x8BA1;&#xFF0C;&#x90FD;&#x662F;&#x76EE;&#x524D;&#x4E1A;&#x754C;&#x6700;&#x901A;&#x7528;&#x7684;&#x914D;&#x7F6E;&#x8BED;&#x6CD5;&#x8BBE;&#x8BA1;&#xFF1B;</li>
<li>&#x68C0;&#x7D22;&#x6027;&#x80FD;&#x9AD8;&#x6548;&#x3002;&#x867D;&#x7136;&#x6BCF;&#x6B21;&#x67E5;&#x8BE2;&#x90FD;&#x662F;&#x5B9E;&#x65F6;&#x8BA1;&#x7B97;&#xFF0C;&#x4F46;&#x662F;&#x4F18;&#x79C0;&#x7684;&#x8BBE;&#x8BA1;&#x548C;&#x5B9E;&#x73B0;&#x57FA;&#x672C;&#x53EF;&#x4EE5;&#x8FBE;&#x5230;&#x5168;&#x5929;&#x6570;&#x636E;&#x67E5;&#x8BE2;&#x7684;&#x79D2;&#x7EA7;&#x54CD;&#x5E94;&#xFF1B;</li>
<li>&#x96C6;&#x7FA4;&#x7EBF;&#x6027;&#x6269;&#x5C55;&#x3002;&#x4E0D;&#x7BA1;&#x662F; Elasticsearch &#x96C6;&#x7FA4;&#x8FD8;&#x662F; Logstash &#x96C6;&#x7FA4;&#x90FD;&#x662F;&#x53EF;&#x4EE5;&#x7EBF;&#x6027;&#x6269;&#x5C55;&#x7684;&#xFF1B;</li>
<li>&#x524D;&#x7AEF;&#x64CD;&#x4F5C;&#x70AB;&#x4E3D;&#x3002;Kibana &#x754C;&#x9762;&#x4E0A;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x70B9;&#x51FB;&#x9F20;&#x6807;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x641C;&#x7D22;&#x3001;&#x805A;&#x5408;&#x529F;&#x80FD;&#xFF0C;&#x751F;&#x6210;&#x70AB;&#x4E3D;&#x7684;&#x4EEA;&#x8868;&#x677F;</li>
</ul>
</blockquote>
<p>&#x76EE;&#x524D;&#x9636;&#x6BB5;&#xFF0C;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x9488;&#x5BF9;LogStash&#x505A;&#x76F8;&#x5E94;&#x7684;&#x9884;&#x7814;&#x3002;</p>
<h4 id="1-logstash&#x662F;&#x4EC0;&#x4E48;">1. LogStash&#x662F;&#x4EC0;&#x4E48;&#xFF1F;</h4>
<p>LogStash&#x662F;&#x5F00;&#x6E90;&#x7684;&#x5177;&#x6709;&#x5B9E;&#x65F6;&#x7BA1;&#x9053;&#x80FD;&#x529B;&#x7684;&#x6570;&#x636E;&#x6536;&#x96C6;&#x5F15;&#x64CE;&#x3002;
<img src="https://www.elastic.co/guide/en/logstash/current/static/images/logstash.png" alt=""></p>
<h4 id="2-logstash&#x80FD;&#x505A;&#x4EC0;&#x4E48;">2. LogStash&#x80FD;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;</h4>
<blockquote>
<ul>
<li>&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x5730;&#x7EDF;&#x4E00;&#x4E0D;&#x540C;&#x6765;&#x6E90;&#x7684;&#x6570;&#x636E;(dynamically unify data from disparate sources)</li>
<li>&#x89C4;&#x6574;&#x6570;&#x636E;&#x5230;&#x60A8;&#x9009;&#x62E9;&#x7684;&#x8F93;&#x51FA;(normalize the data into destinations of your choice)</li>
<li>&#x4E3A;&#x591A;&#x5143;&#x7684;&#x4E0B;&#x6E38;&#x5206;&#x6790;&#x548C;&#x53EF;&#x89C6;&#x5316;&#x65B9;&#x6848;&#x63D0;&#x4F9B; &#x6574;&#x6D01;&#x548C;&#x65E0;&#x5DEE;&#x5F02; &#x7684;&#x6570;&#x636E;(Cleanse and democratize all your data for diverse advanced downstream analytics and visualization use cases)</li>
</ul>
</blockquote>
<p>&#x6240;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x4E8B;&#x4EF6;&#x90FD;&#x53EF;&#x4EE5;&#x88AB;&#x4E30;&#x5BCC;&#x548C;&#x6539;&#x9020;&#xFF0C;&#x5728;&#x7ECF;&#x8FC7;&#x4E00;&#x7CFB;&#x5217;&#x7684;&lt;&#x7BA1;&#x9053;&#x94FE;&gt;input,filter&#x548C;output&#x63D2;&#x4EF6;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x4EE5;&#x53CA;&#x8BB8;&#x591A;&#x7684;&#x672C;&#x5730;&#x7F16;&#x89E3;&#x7801;&#x5668;&#x8FDB;&#x4E00;&#x6B65;&#x7B80;&#x5316;&#x5438;&#x6536;&#x8FC7;&#x7A0B;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x6570;&#x636E;&#x5904;&#x7406;&#xFF1A;</p>
<blockquote>
<ul>
<li>&#x5904;&#x7406;&#x5404;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x65E5;&#x5FD7;&#x548C;&#x6307;&#x6807; [logs and metrics]</li>
<li>&#x89E3;&#x9501;&#x4E07;&#x7EF4;&#x7F51;&#x6570;&#x636E; [Transform HTTP requests into events ]</li>
<li>&#x6316;&#x6398;&#x51FA;&#x5DF2;&#x6709;&#x6570;&#x636E;&#x7684;&#x66F4;&#x591A;&#x66F4;&#x5927;&#x7684;&#x4EF7;&#x503C;[Data Stores and Streams ]</li>
<li>&#x63A2;&#x7D22;&#x5176;&#x5B83;&#x6570;&#x636E;&#x7684;&#x5E7F;&#x5EA6;[&#x4F20;&#x611F;&#x5668;&#x548C;&#x7269;&#x8054;&#x7F51;]</li>
</ul>
</blockquote>
<h4 id="3&#x600E;&#x6837;&#x96C6;&#x6210;&#x4F7F;&#x6211;&#x4EEC;&#x7684;&#x8FD0;&#x7EF4;&#x5E73;&#x53F0;&#x517C;&#x5177;&#x5B9E;&#x65F6;&#x65E5;&#x5FD7;&#x5206;&#x6790;&#x7684;&#x80FD;&#x529B;">3.&#x600E;&#x6837;&#x96C6;&#x6210;&#xFF0C;&#x4F7F;&#x6211;&#x4EEC;&#x7684;&#x8FD0;&#x7EF4;&#x5E73;&#x53F0;&#x517C;&#x5177;&#x5B9E;&#x65F6;&#x65E5;&#x5FD7;&#x5206;&#x6790;&#x7684;&#x80FD;&#x529B;</h4>
<p>ELK Stack &#x7EC4;&#x5408;&#x662F;&#x4E00;&#x5957;&#x5DF2;&#x7ECF;&#x5F88;&#x6210;&#x719F;&#x4E0E;&#x5B8C;&#x6574;&#x7684;&#x4ECE;<strong>&#x6570;&#x636E;&#x91C7;&#x96C6;&#x5206;&#x6790;LogStash-&gt;&#x5B58;&#x50A8;&#x68C0;&#x7D22;Elasticsearch-&gt;&#x524D;&#x7AEF;&#x5C55;&#x793A;Kibana</strong>&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x57FA;&#x4E8E;&#x6211;&#x4EEC;&#x76EE;&#x524D;&#x5E73;&#x53F0;&#x6765;&#x8BF4;&#xFF0C;&#x76F4;&#x63A5;&#x90E8;&#x7F72;&#x4F7F;&#x7528;&#x5373;&#x53EF;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x5236;&#x4F5C;&#x81EA;&#x5DF1;&#x7684;&#x524D;&#x7AEF;&#x5C55;&#x793A;&#x6846;&#x67B6;&#x6765;&#x66FF;&#x6362;Kibana&#xFF0C;&#x4EE5;&#x66F4;&#x52A0;&#x5951;&#x5408;&#x6211;&#x4EEC;&#x76EE;&#x524D;&#x8FD0;&#x7EF4;&#x5E73;&#x53F0;&#x7684;&#x98CE;&#x683C;&#x548C;&#x7279;&#x6027;&#xFF0C;&#x4F46;&#x4EE5;&#x76EE;&#x524D;Kibana&#x76EE;&#x524D;&#x7684;&#x529F;&#x80FD;&#x6765;&#x8BF4;&#xFF0C;&#x8DB3;&#x4EE5;&#x6EE1;&#x8DB3;&#x6211;&#x4EEC;&#x65E5;&#x5FD7;&#x5206;&#x6790;&#x524D;&#x7AEF;&#x5C55;&#x793A;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x5F00;&#x53D1;&#x524D;&#x7AEF;&#x5C55;&#x793A;&#x6240;&#x9700;&#x8981;&#x4ED8;&#x51FA;&#x7684;&#x65F6;&#x95F4;&#x4E0E;&#x7CBE;&#x529B;&#x6765;&#x8BF4;&#xFF0C;&#x5E76;&#x4E0D;&#x5212;&#x7B97;&#x3002;&#x8FD9;&#x4E00;&#x73B0;&#x6210;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x5DF2;&#x7ECF;&#x5F88;&#x5951;&#x5408;&#x6211;&#x4EEC;&#x7684;&#x4E1A;&#x52A1;&#x8981;&#x6C42;&#x5E76;&#x53EF;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x3002;&#x53EA;&#x9700;&#x8981;&#x5728;&#x90E8;&#x7F72;&#x5B8C;&#x6210;&#xFF0C;&#x8003;&#x8651;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x5E73;&#x53F0;&#x754C;&#x9762;&#x6DFB;&#x52A0;&#x76F8;&#x5173;&#x8DF3;&#x8F6C;&#x94FE;&#x63A5;&#x8FC7;&#x53BB;&#x5373;&#x53EF;&#x3002;</p>
<p><strong>&#x81F3;&#x4E8E;ELK&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;&#xFF0C;&#x5219;&#x662F;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x66F4;&#x591A;&#x53BB;&#x8003;&#x91CF;&#x7684;&#x5730;&#x65B9;&#x3002;</strong></p>
<h3 id="elk&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;">ELK&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;</h3>
<h4 id="&#x4E00;&#x4E2A;&#x6700;&#x5C0F;&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;&#x662F;">&#x4E00;&#x4E2A;&#x6700;&#x5C0F;&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;&#x662F;&#xFF1A;</h4>
<blockquote>
<p>&#x9700;&#x8981;&#x4E00;&#x4E2A;Logstash&#x5B9E;&#x4F8B;&#x548C;Elasticsearch&#x5B9E;&#x4F8B;&#xFF0C;Logstash&#x76F4;&#x8FDE;ElasticSearch&#x3002;</p>
</blockquote>
<p><img src="https://www.elastic.co/guide/en/logstash/current/static/images/deploy_1.png" alt=""></p>
<h4 id="&#x4F7F;&#x7528;filters">&#x4F7F;&#x7528;Filters</h4>
<blockquote>
<p>&#x8FD8;&#x662F;&#x6700;&#x5C0F;&#x7684;&#x90E8;&#x7F72;&#x65B9;&#x6848;&#xFF0C;&#x53EA;&#x662F;&#x589E;&#x52A0;&#x4E86;filters&#x914D;&#x7F6E;&#xFF0C;&#x4F46;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x65F6;&#x8D8A;&#x6765;&#x8D8A;&#x6765;&#x591A;&#x7684;&#x6570;&#x636E;&#x548C;&#x8D8A;&#x6765;&#x8D8A;&#x6765;&#x591A;&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#x4F1A;&#x76F4;&#x63A5;&#x5F71;&#x54CD;&#x6027;&#x80FD;&#x3002;</p>
</blockquote>
<p><img src="https://www.elastic.co/guide/en/logstash/current/static/images/deploy_2.png" alt=""></p>
<h4 id="&#x6269;&#x5C55;&#x5230;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;elasticsearch&#x96C6;&#x7FA4;">&#x6269;&#x5C55;&#x5230;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;Elasticsearch&#x96C6;&#x7FA4;</h4>
<blockquote>
<p>Typically, Logstash does not communicate with a single Elasticsearch node, but with a cluster that comprises several nodes. By default, Logstash uses the HTTP protocol to move data into the cluster.</p>
</blockquote>
<p><img src="https://www.elastic.co/guide/en/logstash/current/static/images/deploy_4.png" alt=""></p>
<h4 id="&#x4F7F;&#x7528;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7BA1;&#x7406;&#x541E;&#x5410;&#x7684;&#x5CF0;&#x503C;">&#x4F7F;&#x7528;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7BA1;&#x7406;&#x541E;&#x5410;&#x7684;&#x5CF0;&#x503C;</h4>
<blockquote>
<p>When <strong>the data coming into a Logstash pipeline exceeds the Elasticsearch cluster&#x2019;s ability to ingest the data</strong>, you can use a message queue as a buffer. By default, Logstash throttles incoming events when indexer consumption rates fall below incoming data rates. Since this throttling can lead to events being buffered at the data source, preventing backpressure with message queues becomes an important part of managing your deployment. <br>
When your Logstash deployment has a message queue configured, Logstash functionally exists in two phases: <strong>shipping instances</strong>, which handles data ingestion and storage in the message queue, and <strong>indexing instances</strong>, which retrieve the data from the message queue, apply any configured filtering, and write the filtered data to an Elasticsearch index.</p>
</blockquote>
<p><img src="https://www.elastic.co/guide/en/logstash/current/static/images/deploy_5.png" alt=""></p>
<h4 id="logstash&#x591A;&#x8FDE;&#x63A5;&#x7684;&#x9AD8;&#x53EF;&#x7528;logstash-&#x96C6;&#x7FA4;">LogStash&#x591A;&#x8FDE;&#x63A5;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x2014;&#x2014;logStash &#x96C6;&#x7FA4;</h4>
<blockquote>
<p>To make your Logstash deployment more resilient to individual instance failures, you can <strong>set up a load balancer between your data source machines and the Logstash cluster</strong>. The load balancer handles the individual connections to the Logstash instances to ensure continuity of data ingestion and processing even when an individual instance is unavailable.
<img src="https://www.elastic.co/guide/en/logstash/current/static/images/deploy_7.png" alt=""></p>
</blockquote>
<h3 id="&#x6700;&#x540E;&#x53EF;&#x4F38;&#x7F29;&#x7684;logstash&#x5E94;&#x8BE5;&#x5177;&#x5907;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x6027;">&#x6700;&#x540E;&#xFF0C;&#x53EF;&#x4F38;&#x7F29;&#x7684;Logstash&#x5E94;&#x8BE5;&#x5177;&#x5907;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x6027;</h3>
<p>A mature Logstash deployment typically has the following pipeline:</p>
<blockquote>
<ul>
<li>The input tier consumes data from the source, and consists of Logstash instances with the proper input plugins.</li>
<li>The message queue serves as a buffer to hold ingested data and serve as failover protection.</li>
<li>The filter tier applies parsing and other processing to the data consumed from the message queue.</li>
<li>The indexing tier moves the processed data into Elasticsearch.
Any of these layers can be scaled by adding computing resources. Examine the performance of these components regularly as your use case evolves and add resources as needed. When Logstash routinely throttles incoming events, consider adding storage for your message queue. Alternately, increase the Elasticsearch cluster&#x2019;s rate of data consumption by adding more Logstash indexing instances.</li>
</ul>
</blockquote>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://crazywen.github.io/2016/06/07/ELK stack 之 Logstash 预研/" data-id="cipevi80p0002jspr3qvhecv5" class="article-share-link">分享到</a><div class="tags"><a href="/tags/ELK/">ELK</a><a href="/tags/log/">log</a></div><div class="post-nav"><a href="/2016/06/12/ELK stack 之 ElasticSearch  预研/" class="pre">ELK stack 之 ElasticSearch  预研</a><a href="/2016/05/31/Shell 脚本编程 —— 秘笈2/" class="next">Shell 脚本编程 —— 秘笈2</a></div><div data-thread-key="2016/06/07/ELK stack 之 Logstash 预研/" data-title="ELK stack 之 Logstash  预研" data-url="http://crazywen.github.io/2016/06/07/ELK stack 之 Logstash 预研/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/06/07/ELK stack 之 Logstash 预研/" data-title="ELK stack 之 Logstash  预研" data-url="http://crazywen.github.io/2016/06/07/ELK stack 之 Logstash 预研/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://crazywen.github.io"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/工作/">工作</a></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/职责/" style="font-size: 15px;">职责</a> <a href="/tags/ELK/" style="font-size: 15px;">ELK</a> <a href="/tags/log/" style="font-size: 15px;">log</a> <a href="/tags/http2-0/" style="font-size: 15px;">http2.0</a> <a href="/tags/Multiplexing/" style="font-size: 15px;">Multiplexing</a> <a href="/tags/elasticsearch/" style="font-size: 15px;">elasticsearch</a> <a href="/tags/软件设计/" style="font-size: 15px;">软件设计</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/install/" style="font-size: 15px;">install</a> <a href="/tags/面向对象/" style="font-size: 15px;">面向对象</a> <a href="/tags/Shell/" style="font-size: 15px;">Shell</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/进程/" style="font-size: 15px;">进程</a> <a href="/tags/线程/" style="font-size: 15px;">线程</a> <a href="/tags/并行/" style="font-size: 15px;">并行</a> <a href="/tags/并发/" style="font-size: 15px;">并发</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/06/14/ELKStack 安装指南-基于centOs6/">ELKStack 安装指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/12/ELK stack 之 ElasticSearch  预研/">ELK stack 之 ElasticSearch  预研</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/07/ELK stack 之 Logstash 预研/">ELK stack 之 Logstash  预研</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/31/Shell 脚本编程 —— 秘笈2/">Shell 脚本编程 —— 秘笈2</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/30/Shell 脚本编程 —— 秘笈1/">Shell 脚本编程 —— 秘笈1</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/19/卓越软件设计匠艺 —— 培训总结/">卓越软件设计匠艺 —— 培训总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/19/进程和线程/">进程和线程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/19/http2.0/">HTTP2.0 的改进</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/并行与并发/">并行和并发的区别</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/crazywen/" title="github-me" target="_blank">github-me</a><ul></ul><a href="https://qdan.me/" title="轻单" target="_blank">轻单</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">深度空间.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'crazywen'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>